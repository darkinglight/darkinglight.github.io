---
layout: post
title: 浅析小端序
categories: [c++, 计算机原理]
tags: [c++, 计算机原理]
description: 小端序原理浅析。
---

    如果把现金看作一项资产，收益率以长期存款利率3%计，可以认为现金的roe为3。同时，也没有人会用100块购买50块现金，只会100置换100，可以认为现金的pb为1。
    年初持有现金资产v0，N年后，资产为v0*(1 + 0.03)^N

    假设有一种资产B，roe为6，可以和现金按一定比例互换，你愿意用多少现金置换100的资产B。
    年初持有资产B v0，N年后，资产为v0 + v0*0.06*(1+0.03)^0 + v0*0.06*(1+0.03)^1 + ... + v0*0.06*(1+0.03)^(N-1):



















































    pv = fv/(1+r)^0 + fv/(1+r)^1 + fv(1+r)^2 + ... + fv/(1+r)^n
    pv/(1+r) = fv/(1+r)^1 + fv(1+r)^2 + ... + fv/(1+r)^n + fv/(1+r)^(n+1)
    pv*r/(1+r) = fv - fv/(1+r)^(n+1) = fv
    pv = fv*(1+r)/r = fv * (1+10%)/10% = fv * 11
    pv = asset * roe / 100 * 11
    pb = roe * 11%
    roe/pb = 9

    fv(future value): 未来每年的自由现金流价值
    pv(price value): 对应的现值

    DCF的公式为：PV = FV / (1 + r)^n
    其中，PV是现值，FV是未来值，r是折现率，n是时间。
    假设未来现金流每年增长g，那么第n年的现金流FV可以表示为：
    FV = FV0 * (1 + g)^n
    其中，FV0是第一年的现金流
    将这个公式带入DCF公式，可以得到：
    PV = FV0 * (1 + g)^n / (1 + r)^n
    假设一个企业的存续期为永续存在，这个企业在生命周期中获得的现金流现值如下：
    PVtotal = FV0 + FV0 * (1 + g) / (1 + r) + FV0 * (1 + g)^2 / (1 + r)^2 + ... + FV0 * (1 + g)^n / (1 + r)^n
    PVtotal * (1 + g) / (1 + r) = FV0 * (1 + g) / (1 + r) + FV0 * (1 + g)^3 / (1 + r)^r3 + ... + FV0 * (1 + g)^(n+1) / (1 + r)^(n+1)
    PVtotal * (r - g) / (1 + r) = FV0 - FV0 * (1 + g)^(n+1) / (1 + r)^(n+1)
    永续增长率g必然小于折现率r，不然现值无限大，全世界的钱都被是你的，显然不合常理，所以可以认为
    FV0 * (1 + g)^(n+1) / (1 + r)^(n+1) = 0,则
    PVtotal * (r - g) / (1 + r) = FV0
    PVtotal = FV0 * (1 + r) / (r - g)
    这个公式和我们买股票有什么关系呢。从绝对的角度看，很难说有多大的价值，长期增长率和折现率都是很艺术的东西，而且需要预判未来，所以想从这个公式得到公司的价值基本上可以放弃。但是从相对的角度看，价值会高不少，我们可以用这个公式对比多家公司，找到性价比最高的。打个比方，一杆失准的称，称不出一个人的准确体重，但是依然可以称出两个人谁更重一点。
    我们把PVtotal作为公司内在价值=合理市值，PV0=公司第一年的分红，g=公司过去5的平均增长率作为未来长期增长率。折现率r需要重点说下，常见的折现率为长期国债利率+风险溢价，一般给个10%，这里为了给g一个较大取值范围，所以给r取一个较大值15%，那么g的取值范围为[0,15), PVtotal = FV0 * 1.15 / (15% - g)
    roe = 股息率x + 增长率g
    这里做个简单转化，假设自由现金流=分红，则FV0 = 净资产 * roe * 分红率，可推导出：
    PVtotal / 净资产 = x * (1 + r) / (r - g)
    roe = x + g
    合理pb = x * (1 + r) / (r - g)
    下面拿两个企业做简单对比：
1. 假设企业的净资产为A，roe=20%，收益50%进行分红,则：
PVtotal = A * 20% * 50% * 1.15 / (15% - 20% * 50%) = A * 0.1 * 1.15 / 0.05
=> 合理pb = PVtotal / A = 115 / 50 = 2.3
2. 假设企业的净资产为A，roe=20%，收益75%进行分红,则：
PVtotal = A * 20% * 75% * 1.15 / (15% - 20% * 25%) = A * 0.15 * 1.15 / 0.1
=> pb = PVtotal / A = 1.725
3. 假设企业的净资产为A，roe=15%，收益1/3进行分红,则：
PVtotal = A * 15% * 1/3 * 1.15 / (15% - 15% * 2/3) = A * 0.05 * 1.15 / 0.05
=> 合理pb = PVtotal / A = 1.15
4. 假设企业的净资产为A，roe=14%，收益1/2进行分红,则：
PVtotal = A * 7% * 1.15 / (15% - 7%) = A * 0.07 * 1.15 / 0.08
=> 合理pb = PVtotal / A = 1

    pb = x * 1.1 / (0.1 - g)

1. roe=5% x=5% g=0
pb = 0.05 * 1.1 / 0.1 = 0.55
2. roe=5% x=2% g=3%
pb = 0.03 * 1.1 / (0.1 - 0.02) = 1.1 * 3 / 8 = 0.4125
3. roe=5% x=0% g=5%
pb = 0.00 * 1.1 / (0.1 - 0.05) = 0

1. roe=10% x=10% g=0
pb = 0.1 * 1.1 / 0.1 = 1.1
2. roe=10% x=7% g=3%
pb = 0.07 * 1.1 / (0.1 - 0.03) = 1.1
3. roe=10% x=5% g=5%
pb = 0.05 * 1.1 / (0.1 - 0.05) = 1.1

1. roe=20% x=20% g=0
pb = 0.2 * 1.1 / 0.1 = 2.2
2. roe=20% x=17% g=3%
pb = 0.17 * 1.1 / (0.1 - 0.03) = 0.17 * 1.1 / 0.07 = 2.42 * 1.1 = 2.67
3. roe=20% x=15% g=5%
pb = 0.15 * 1.1 / (0.1 - 0.05) = 0.15 * 1.1 / 0.05 = 3 * 1.1 = 3.3
